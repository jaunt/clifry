<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>clifry</title><meta name="description" content="Documentation for clifry"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">clifry</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>clifry</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#clifry" id="clifry" style="color: inherit; text-decoration: none;">
  <h1>Clifry</h1>
</a>

<a href="#cli-functional-testing-tool-powered-by-nodejs" id="cli-functional-testing-tool-powered-by-nodejs" style="color: inherit; text-decoration: none;">
  <h4>CLI Functional Testing tool powered by Node.JS</h4>
</a>

<a href="#design-philosophy" id="design-philosophy" style="color: inherit; text-decoration: none;">
  <h2>Design Philosophy</h2>
</a>
<p>Clifry is a tool to black-box test command line interpreter apps (CLIs) by writing simple javascript code.</p>
<p>Instead of having to learn how to configure a taskrunner tool like grunt or gulp, the idea here is to write javascript code with a very simple API honed for running and testing CLIs.</p>
<p>Clifry doesn&#39;t provide much in the way of actual domain specific testing functinlaity. It&#39;s up to you to use something like the standard unix diff tool if you want to compare human-readable file outputs, or any external tool you need depending on the nature of your CLI. You can easily require npm modules of your choosing in your javascript test files, as long as they are compatible with Node.js.</p>
<p>If you&#39;re only interested in what your CLI spits out to stdio or stder, you can use simple javascript to compare what you expected to what you saw.</p>
<p>Clifry will always stay lean and minimal, by design.</p>
<p>Note: Clifry was created to test black-box-test Airfry, a javascript static site generator. So it&#39;s battle tested in that way.</p>

<a href="#how-to-write-tests" id="how-to-write-tests" style="color: inherit; text-decoration: none;">
  <h2>How To Write Tests</h2>
</a>
<p>Clifry will run tests against a CLI that you specify as an argument. You write each test in its own javascript file.</p>
<p>A clifry test accepts an instance of the api object, and returns a promise to resolve (pass) or reject (fail) the test.</p>
<p>The API object passed to your test provides a minimal set of functions designed to make it easy to interact with your CLI for functional testing purposes.</p>
<p>Most of these functions are designed to be used with javascript&#39;s <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Async_await">async await mechanism.</a></p>

<a href="#example-testjs-file-run-python-interactively-to-make-sure-it-can-do-math" id="example-testjs-file-run-python-interactively-to-make-sure-it-can-do-math" style="color: inherit; text-decoration: none;">
  <h5>Example test.js file: run python interactively to make sure it can do math</h5>
</a>
<pre><code class="language-javascript"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">timeout</span><span class="hl-1"> = </span><span class="hl-3">5000</span><span class="hl-1">;</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-4">test</span><span class="hl-1"> = (</span><span class="hl-5">CliFry</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-7">Promise</span><span class="hl-1">(</span><span class="hl-0">async</span><span class="hl-1"> </span><span class="hl-0">function</span><span class="hl-1"> (</span><span class="hl-5">resolve</span><span class="hl-1">, </span><span class="hl-5">reject</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">testRun</span><span class="hl-1"> = </span><span class="hl-4">CliFry</span><span class="hl-1">(</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-5">name:</span><span class="hl-1"> </span><span class="hl-8">&quot;Simple Test&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-5">description:</span><span class="hl-1"> </span><span class="hl-8">&quot;Run python, do some math, exit.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-9">// arguments</span><br/><span class="hl-1">      [</span><span class="hl-8">&quot;-i&quot;</span><span class="hl-1">, </span><span class="hl-8">&quot;-q&quot;</span><span class="hl-1">]</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">    </span><span class="hl-5">testRun</span><span class="hl-1">.</span><span class="hl-4">start</span><span class="hl-1">();</span><br/><br/><span class="hl-1">    </span><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-5">success</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-5">success</span><span class="hl-1"> = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-5">testRun</span><span class="hl-1">.</span><span class="hl-4">untilStderrIncludes</span><span class="hl-1">(</span><span class="hl-8">&quot;&gt;&gt;&gt;&quot;</span><span class="hl-1">, </span><span class="hl-5">timeout</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-6">if</span><span class="hl-1"> (!</span><span class="hl-5">success</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">reject</span><span class="hl-1">(</span><span class="hl-8">&quot;Did not get python prompt&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">return</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-5">testRun</span><span class="hl-1">.</span><span class="hl-4">write</span><span class="hl-1">(</span><span class="hl-8">&quot;10+10&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-5">success</span><span class="hl-1"> = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-5">testRun</span><span class="hl-1">.</span><span class="hl-4">untilStdoutIncludes</span><span class="hl-1">(</span><span class="hl-8">&quot;20&quot;</span><span class="hl-1">, </span><span class="hl-3">2000</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-6">if</span><span class="hl-1"> (!</span><span class="hl-5">success</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">reject</span><span class="hl-1">(</span><span class="hl-8">&quot;Python does not know math.&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-5">testRun</span><span class="hl-1">.</span><span class="hl-4">write</span><span class="hl-1">(</span><span class="hl-8">&quot;exit()&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-5">success</span><span class="hl-1"> = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-5">testRun</span><span class="hl-1">.</span><span class="hl-4">stopped</span><span class="hl-1">(</span><span class="hl-5">timeout</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-6">if</span><span class="hl-1"> (!</span><span class="hl-5">success</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">reject</span><span class="hl-1">(</span><span class="hl-8">&quot;Python would not shutdown gracefully&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-6">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">resolve</span><span class="hl-1">(</span><span class="hl-8">&quot;Python is great!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">};</span><br/><span class="hl-7">module</span><span class="hl-1">.</span><span class="hl-7">exports</span><span class="hl-1"> = </span><span class="hl-5">test</span><span class="hl-1">;</span>
</code></pre>
<p>Hopefully the above is somewhat self explanitory.</p>
<p>Of course testing <em>stdout</em> and <em>stderr</em> is only one aspect of testing a CLI. In the case of Airfry, a static site generator, the clifry tests were written to use the unix diff command to compare site outputs at different stages. Refer to the <a href="https://github.com/jaunt/airfryts/tree/main/tests">Airfry test folder in git</a> to see how it works.</p>
<p>Clifry is designed so that you include anything you need to test the domain specific data you are testing for within your javascript test files. You can use npm and require as you desire. Perhaps you want to compare audio or video files at each step of the test. There&#39;s probably an NPM for that!</p>

<a href="#how-to-call-clifry" id="how-to-call-clifry" style="color: inherit; text-decoration: none;">
  <h2>How to call Clifry</h2>
</a>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/ClifryAPI.html" class="tsd-kind-icon">ClifryAPI</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>